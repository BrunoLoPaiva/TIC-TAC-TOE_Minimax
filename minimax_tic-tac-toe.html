<!DOCTYPE html>
<html>

<head>
    <title>Jogo da Velha</title>
    <style>
        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-gap: 10px;
            background-color: #494949;
            padding: 10px;
        }

        .cell {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
            width: 100px;
            font-size: 36px;
            background-color: #f2f2f2;
            cursor: pointer;
        }

        .cell:hover {
            background-color: #e0e0e0;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="board">
            <div class="cell" onclick="makeMove(0)"></div>
            <div class="cell" onclick="makeMove(1)"></div>
            <div class="cell" onclick="makeMove(2)"></div>
            <div class="cell" onclick="makeMove(3)"></div>
            <div class="cell" onclick="makeMove(4)"></div>
            <div class="cell" onclick="makeMove(5)"></div>
            <div class="cell" onclick="makeMove(6)"></div>
            <div class="cell" onclick="makeMove(7)"></div>
            <div class="cell" onclick="makeMove(8)"></div>
        </div>
    </div>

    <script>
        // Variáveis do jogo
        let board = ['', '', '', '', '', '', '', '', ''];
        let currentPlayer = 'X';

        // Função para fazer uma jogada no tabuleiro
        function makeMove(index) {
            if (board[index] !== '' || currentPlayer !== 'X') {
                return;
            }

            board[index] = currentPlayer;
            document.getElementsByClassName('cell')[index].innerText = currentPlayer;

            // Verificar o resultado do jogo
            if (checkWinner(board)) {
                alert('Vencedor: ' + currentPlayer);
                resetBoard();
                return;
            } else if (isGameOver(board)) {
                alert('Empate!');
                resetBoard();
                return;
            }

            currentPlayer = currentPlayer === 'X' ? 'O' : 'X';

            // Jogada do computador
            setTimeout(computerMove, 500);
        }

        // Função para verificar se algum jogador venceu o jogo
        function checkWinner(board) {
            const winningCombinations = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], // Linhas
                [0, 3, 6], [1, 4, 7], [2, 5, 8], // Colunas
                [0, 4, 8], [2, 4, 6] // Diagonais
            ];

            for (let combination of winningCombinations) {
                const [a, b, c] = combination;
                if (board[a] !== '' && board[a] === board[b] && board[a] === board[c]) {
                    return true;
                }
            }

            return false; // Nenhum vencedor
        }

        // Função para verificar se o jogo terminou (empate ou vitória)
        function isGameOver(board) {
            return checkWinner(board) || board.every(cell => cell !== '');
        }

        // Função para reiniciar o tabuleiro
        function resetBoard() {
            board = ['', '', '', '', '', '', '', '', ''];
            currentPlayer = 'X';

            const cells = document.getElementsByClassName('cell');
            for (let i = 0; i < cells.length; i++) {
                cells[i].innerText = '';
            }
        }

        // Função para a jogada do computador usando o algoritmo Minimax
        function computerMove() {
            const moves = generateMoves(board);
            let bestMove;
            let bestEval = -Infinity;

            for (let move of moves) {
                const eval = minimax(makeMove(board, move, 'O'), 9, false);
                if (eval > bestEval) {
                    bestEval = eval;
                    bestMove = move;
                }
            }
            console.log('aqui')

            makeMove(bestMove);
        }

        // Função para gerar os movimentos possíveis
        function generateMoves(board) {
            const moves = [];
            for (let i = 0; i < board.length; i++) {
                if (board[i] === '') {
                    moves.push(i);
                }
            }
            return moves;
        }

        // Função Minimax (recursiva)
        function minimax(board, depth, maximizingPlayer) {
            if (isGameOver(board) || depth === 0) {
                const winner = checkWinner(board);
                if (winner === 'X') {
                    return 1; // Vitória do jogador 'X'
                } else if (winner === 'O') {
                    return -1; // Vitória do jogador 'O'
                }
                return 0; // Empate
            }

            if (maximizingPlayer) {
                let maxEval = -Infinity;
                const moves = generateMoves(board);
                for (let move of moves) {
                    const eval = minimax(makeMove(board, move, 'X'), depth - 1, false);
                    maxEval = Math.max(maxEval, eval);
                }
                return maxEval;
            } else {
                let minEval = Infinity;
                const moves = generateMoves(board);
                for (let move of moves) {
                    const eval = minimax(makeMove(board, move, 'O'), depth - 1, true);
                    minEval = Math.min(minEval, eval);
                }
                return minEval;
            }
        }
    </script>
</body>

</html>
